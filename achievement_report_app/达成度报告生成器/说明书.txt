================================================================================
                        达成度报告生成器 v1.2
                            使用说明书
================================================================================

【快速入门】3步生成报告

    第1步：点击"选择文件"，选择成绩单Excel文件（支持多选）
    第2步：确认配置参数（默认参数通常无需修改）
    第3步：点击"生成报告"，等待完成即可

    生成的报告保存在成绩单所在目录，文件名为：原文件名_达成度报告.xlsx

    提示：生成后可点击"打开输出目录"按钮快速定位到生成的文件

================================================================================

【v1.2 新增功能】

    · 文件覆盖确认 - 输出目录存在同名文件时弹出确认对话框：
      - 点击「是」覆盖原文件
      - 点击「否」自动重命名（添加 _1, _2 后缀）
      - 点击「取消」跳过此文件
    · 输出目录"清空"按钮 - 快速重置输出目录设置
    · 配置参数"恢复默认"按钮 - 一键恢复默认配置
    · 进度条自动隐藏 - 处理完成后自动隐藏
    · 班级识别增强 - 新增从工作表名称、文件名提取班级信息
    · 学号识别放宽 - 支持包含少量字母的学号格式
    · 多列并排数据 - 支持同一工作表包含多组学生数据

================================================================================

【v1.1 功能】

    · 📖 说明书按钮 - 右上角可直接打开本说明书
    · 📂 打开输出目录按钮 - 快速打开并定位到生成的报告文件
    · 文件列表字体加大，更易阅读
    · 图表X轴标签根据学生数量自动调整间隔
    · 班级识别更灵活：
      - 支持"行政班：XXX"、"班级：XXX"等多种格式
      - 支持从列数据中读取每个学生的班级
      - 班级信息可选，缺失时班级列留空并提示警告
    · 界面文字颜色优化，提高可读性

================================================================================

【软件简介】

    本软件用于从学生成绩单Excel文件生成达成度分析报告。

    主要功能：
    · 支持批量处理多个成绩单文件
    · 自动识别成绩单结构，无需手动调整格式
    · 自动计算各项达成度指标
    · 生成包含图表的完整报告

【系统要求】

    Windows: Windows 10 或更高版本
    macOS:   macOS 10.14 (Mojave) 或更高版本

【安装说明】

    Windows:
        双击 "达成度报告生成器.exe" 即可运行，无需安装
        （首次运行可能需要允许安全软件权限）

    macOS:
        双击 "达成度报告生成器.app" 运行
        如提示"无法打开"，请右键点击 → 选择"打开"

================================================================================

【成绩单格式要求】★重要★

    您的成绩单Excel文件需要包含以下内容：

    ┌─────────────────────────────────────────────────────────┐
    │  示例结构：                                              │
    │                                                         │
    │  行政班：22软件工程1班                                   │
    │                                                         │
    │  学号        姓名      平时成绩    期末成绩    总成绩    │
    │  2022001     张三        85          78         80      │
    │  2022002     李四        90          85         87      │
    │  2022003     王五        缺考        缺考       缺考    │
    │  ...                                                    │
    └─────────────────────────────────────────────────────────┘

    必需信息：
    · 学号、姓名列
    · 平时成绩、期末成绩、总成绩列

    班级信息（可选，自动识别优先级）：
    · 单元格内容：行政班：XXX 或 班级：XXX
    · 工作表名称：如"9007851-0001_音乐2212"→提取"音乐2212"
    · 文件名：如"软件工程2301_成绩.xlsx"→提取"软件工程2301"
    · 列数据：列头为"班级"或"行政班"，每行有各自班级
    · 如未找到班级信息，程序仍可运行，班级列将留空

    列名支持多种写法：
    · 期末成绩 → 也可写作"期末"、"期末考试"
    · 平时成绩 → 也可写作"平时"、"平时分"
    · 总成绩   → 也可写作"总评成绩"、"成绩"、"总评"

    特殊状态学生：
    · 缺考、缓考、作弊、取消、免修、旷考等状态会自动识别
    · 这些学生保留基本信息，不参与达成度计算

    多列并排数据：
    · v1.2起支持同一工作表包含多组并排的学生数据
    · 程序会自动识别并正确处理每组数据

================================================================================

【详细使用步骤】

    1. 选择成绩单文件
       · 点击"选择文件"按钮
       · 在弹出的窗口中选择Excel文件（可按住Ctrl/Command多选）
       · 选中的文件会显示在列表中，带序号方便确认
       · 点击"清空"可清除已选文件

    2. 选择输出目录（可选）
       · 点击"选择目录"设置报告保存位置
       · 不设置则默认保存到成绩单所在目录
       · 点击"清空"可重置输出目录设置

    3. 配置参数（通常无需修改）
       ┌────────────────────────────────────────┐
       │  目标一占比: 50%  ┐                     │
       │  目标二占比: 30%  ├─ 三项之和必须=100%  │
       │  目标三占比: 20%  ┘                     │
       │                                        │
       │  平时成绩占比: 30% ┐                    │
       │  期末成绩占比: 70% ┴─ 两项之和必须=100% │
       │                                        │
       │  达成度期望值: 0.6（范围0-1）           │
       └────────────────────────────────────────┘

       输入时会实时验证，有效显示绿色✓，错误显示红色⚠️
       点击"恢复默认"可一键恢复为默认参数

    4. 生成报告
       · 点击"生成报告"按钮
       · 进度条显示处理进度（完成后自动隐藏）
       · 如遇同名文件会弹出确认对话框
       · 完成后显示处理结果（成功数、失败数、跳过数、警告信息）

【输出报告内容】

    生成的报告包含两个工作表：

    工作表1「课程目标达成度计算」
    · 学生基本信息（班级、学号、姓名）
    · 各项成绩和达成率计算
    · 4个折线图：目标1/2/3达成度 + 总达成度

    工作表2「达成度统计」
    · 达成度分级统计表
      - 完全达成 (>0.8)
      - 较好达成 (0.6-0.8)
      - 基本达成 (0.5-0.6)
      - 较少达成 (0.4-0.5)
      - 没有达成 (<0.4)
    · 3个柱状图：各目标达成度分布

================================================================================

【常见问题解答】

    Q: 提示"文件已存在"怎么办？
    A: v1.2起会弹出确认对话框，您可以选择：
       - 覆盖：替换原文件
       - 重命名：自动添加 _1, _2 等后缀
       - 跳过：不处理此文件

    Q: 提示"未找到行政班/班级信息"怎么办？
    A: 班级信息已变为可选。如需填充班级列，可在成绩单中：
       - 添加"行政班：XXX"或"班级：XXX"格式的信息
       - 或添加"班级"列，每行填写对应班级名称
       - 或使用包含班级信息的工作表名称/文件名

    Q: 提示"缺少必需列"怎么办？
    A: 检查成绩单是否包含：学号、姓名、平时成绩、期末成绩、总成绩
       列名可以是上面提到的任意一种写法

    Q: 为什么有些工作表被跳过了？
    A: 可能是该工作表缺少必需信息，查看警告详情了解具体原因
       （如空白Sheet或格式不符合要求的工作表会自动跳过）

    Q: 配置参数显示红色警告怎么办？
    A: 检查目标占比之和是否为100%，成绩占比之和是否为100%
       或点击"恢复默认"按钮恢复默认配置

    Q: macOS提示"无法验证开发者"怎么办？
    A: 右键点击应用 → 选择"打开" → 在弹窗中点击"打开"

    Q: 文件无法读取怎么办？
    A: 请确保成绩单文件没有被Excel或其他程序打开

【注意事项】

    · 处理前请确保成绩单文件已关闭（未被其他程序占用）
    · 建议处理前备份原始成绩单文件
    · 批量处理大量文件时请耐心等待
    · 如遇问题，请查看界面上的错误提示信息

================================================================================

【版权信息】

    © 2025 集美大学 达成度报告生成器 v1.2
    作者：刘祉祁

================================================================================
